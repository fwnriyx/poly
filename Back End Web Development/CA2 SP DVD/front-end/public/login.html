<!DOCTYPE html>
<html>

<head>
  <title>SP DVD | Login</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
    integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.1/css/all.css"
    integrity="sha384-gfdkjb5BdAXd+lj+gudLWI+BXq4IuLW5IT+brZEZsLFm++aCMlF1V92rMkPaX4PP" crossorigin="anonymous">

  <!--Bootstrap stuff-->
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <!-- jQuery library -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <!-- Popper JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <!-- Latest compiled JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

  <link href="css/log.css" rel="stylesheet">
</head>

<body>
      <!--navigation tab-->
      <nav class="navbar navbar-expand-lg bg-dark navbar-dark">
        <a class="navbar-brand" href="#"><b class="text-danger">SP DVD</b></a>

        <div class="collapse navbar-collapse" id="navbarTogglerDemo02">
            <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
                <li class="nav-item">
                    <a class="nav-link" href="index.html">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="DVD.html">Products</a>
                </li>
                <li class="nav-item" id="adminF"></li>
            </ul>
        </div>
    </nav>
  <div class="login">
    <h1>Admin Login</h1>
    <form method="post">
      <input type="text" id="email" name="" placeholder="Email" required="required" class="form-control input_user" />
      <div class="input-group mb-2">
        <div class="input-group-append">
        </div>
        <input type="password" name="" id="pwd" class="form-control input_pass" placeholder="Password"
          required="required" />
      </div>
      <div id="wrong"></div>
      <button type="button" name="button" id="Login" class="btn btn-primary btn-block btn-large login_btn">Let me in.</button>
    </form>
  </div>
  </div>
  <script>
    $(document).ready(function () {
      $("#Login").click(function () {
        var id = $('#email').val();
        var pwd = $('#pwd').val();
        var data = `{"email": "${id}", "password": "${pwd}"}`;
        $.ajax({
          url: 'http://localhost:3000/login',
          type: 'POST',
          data: data,
          contentType: "application/json; charset=utf-8",
          dataType: "json",
          success: function (data, status, xhr) {
            if (data != null) {
              console.log(data)
              localStorage.setItem('token', data.token);
              localStorage.setItem('staff_id', data.staff_id);
              window.location.assign("./index.html");
            } else {
              console.log("Error");
            }
          },
          error: function (xhr, textStatus, errorThrown) {
            console.log('wrong password');
            document.getElementById('wrong').innerHTML = "<p class='text-danger'>Wrong Credentials. Please try again.</p>"
          }
        });
        return false;
      });
    });
  </script>
  <script>
      $(document).ready(function () {
          if (localStorage.getItem('token')) {
              console.log(localStorage.getItem('token'))
              document.getElementById("adminF").innerHTML = `<a class="nav-link" id="adminf" href="./add.html">Admin</a>`
          } else {
              console.log("not logged in")
              document.getElementById("adminF").innerHTML = `<a class="nav-link" id="adminf" href="./login.html">Admin</a>`
          }
      })
  </script>
</body>


</html>